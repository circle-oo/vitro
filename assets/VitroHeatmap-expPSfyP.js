import{r as f,j as t,b as R}from"./vendor-react-DQm72ddU.js";import{u as W,g as Y}from"./useVitroChartTheme-CSrLzm8s.js";import{C as H,a as E,b as X}from"./chartShared-D7T1rNh3.js";import{R as O,B as J,c as K,X as z,Y as P,T as q,e as Q}from"./vendor-recharts-E02QUYP5.js";function ot({data:r,dataKey:l,xKey:s,height:a=200,gradientId:m,animated:c=!1}){const p=f.useId().replace(/:/g,""),j=m??`vitroBarGrad-${p}`,d=W();return t.jsx(O,{width:"100%",height:a,children:t.jsxs(J,{data:r,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:j,x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:d.primary,stopOpacity:1}),t.jsx("stop",{offset:"100%",stopColor:d.primary,stopOpacity:.5})]})}),t.jsx(K,{...H(d)}),t.jsx(z,{dataKey:s,tick:E(d)}),t.jsx(P,{tick:E(d),width:X}),t.jsx(q,{contentStyle:Y(d.mode),itemStyle:{color:d.mode==="light"?"#111827":"#F8FAFC",fontSize:12,fontWeight:300},labelStyle:{color:d.mode==="light"?"#6B7280":"#CBD5E1",fontSize:11,fontWeight:300}}),t.jsx(Q,{dataKey:l,fill:`url(#${j})`,radius:[4,4,0,0],isAnimationActive:c})]})})}const U=["","Mon","","Wed","","Fri",""],V=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N(r){const l=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${l}-${s}-${a}`}function Z(r){const l=r.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!l)return null;const s=Number(l[1]),a=Number(l[2])-1,m=Number(l[3]),c=new Date(s,a,m);return Number.isNaN(c.getTime())||c.getFullYear()!==s||c.getMonth()!==a||c.getDate()!==m?null:c}function G(r,l){if(r<=0||l<=0)return 0;const s=r/l;return s<=.25?1:s<=.5?2:s<=.75?3:4}function it({data:r,summary:l,cellSize:s=13,cellGap:a=3,className:m}){const[c,p]=f.useState(null),j=W(),{grid:d,monthLabels:T,maxVal:k}=f.useMemo(()=>{if(r.length===0)return{grid:[],monthLabels:[],maxVal:0};const n=new Map;let i=0;const h=[];for(const e of r){const o=Z(e.date);if(!o)continue;const u=N(o);n.set(u,e.value),e.value>i&&(i=e.value),h.push(o)}if(h.length===0)return{grid:[],monthLabels:[],maxVal:0};const x=new Date(Math.min(...h.map(e=>e.getTime()))),D=new Date(Math.max(...h.map(e=>e.getTime()))),v=new Date(x);v.setDate(v.getDate()-v.getDay());const M=new Date(D);M.setDate(M.getDate()+(6-M.getDay()));const S=[],g=new Date(v);for(;g<=M;){const e=[];for(let o=0;o<7;o++){const u=N(g);e.push({date:new Date(g),key:u,value:n.get(u)??0}),g.setDate(g.getDate()+1)}S.push(e)}const b=new Map;let y=-1;S.forEach((e,o)=>{e.forEach(u=>{u.date>=x&&u.date<=D&&(y<0&&(y=o),u.date.getDate()===1&&b.set(o,V[u.date.getMonth()]))})}),y>=0&&!b.has(y)&&b.set(y,V[x.getMonth()]);const F=Array.from(b.entries()).map(([e,o])=>({weekIndex:e,label:o})).sort((e,o)=>e.weekIndex-o.weekIndex),w=[];for(const e of F){const o=w[w.length-1];(!o||e.weekIndex-o.weekIndex>=2)&&w.push(e)}return{grid:S,monthLabels:w,maxVal:i}},[r]),_=d.length,C=32,L=Math.max(0,_*(s+a)-a),A=f.useCallback((n,i)=>{p({x:n.clientX,y:n.clientY,text:`${i.value} on ${i.key}`})},[]),I=f.useCallback(n=>{const{clientX:i,clientY:h}=n;p(x=>x?x.x===i&&x.y===h?x:{...x,x:i,y:h}:null)},[]),$=f.useCallback(()=>{p(null)},[]),B=f.useMemo(()=>t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{display:"flex",marginLeft:C+a,marginBottom:"4px",position:"relative",height:"16px",width:L},children:T.map((n,i)=>t.jsx("span",{style:{position:"absolute",left:n.weekIndex*(s+a),fontSize:"11px",color:"var(--t4)",fontWeight:200},children:n.label},`${n.label}-${i}`))}),t.jsxs("div",{style:{display:"flex",gap:`${a}px`},children:[t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:`${a}px`,width:C,flexShrink:0},children:U.map((n,i)=>t.jsx("div",{style:{height:s,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"6px",fontSize:"11px",color:"var(--t4)",fontWeight:200},children:n},i))}),d.map((n,i)=>t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:`${a}px`},children:n.map(h=>{const x=G(h.value,k);return t.jsx("div",{className:`hmc hm${x}`,style:{width:s,height:s},onMouseEnter:D=>A(D,h),onMouseMove:I,onMouseLeave:$},h.key)})},i))]})]}),[a,s,d,L,A,$,I,k,T]);return t.jsxs("div",{className:m,children:[B,t.jsxs("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"12px",flexWrap:"wrap",marginTop:"10px",marginLeft:C+a},children:[l&&t.jsx("span",{style:{fontSize:"11px",color:"var(--t4)"},children:l}),t.jsxs("div",{className:"hmleg",children:[t.jsx("span",{children:"Less"}),[0,1,2,3,4].map(n=>t.jsx("i",{className:`hm${n}`},n)),t.jsx("span",{children:"More"})]})]}),c&&R.createPortal(t.jsx("div",{style:{position:"fixed",zIndex:999,fontFamily:"var(--font)",pointerEvents:"none",whiteSpace:"nowrap",left:c.x+12,top:c.y-32,...Y(j.mode)},children:c.text}),document.body)]})}export{it as V,ot as a};
