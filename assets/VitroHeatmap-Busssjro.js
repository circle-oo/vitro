import{r as S,j as t,b as Y}from"./vendor-react-DQm72ddU.js";import{u as $,g as k}from"./useVitroChartTheme-CsFoZV6w.js";import{C as _,a as C,b as B}from"./chartShared-D7T1rNh3.js";import{R,B as F,d as H,X,Y as O,T as J,f as K}from"./vendor-recharts-CmCmrmcd.js";function et({data:o,dataKey:r,xKey:n,height:a=200,gradientId:m}){const l=S.useId().replace(/:/g,""),u=m??`vitroBarGrad-${l}`,d=$();return t.jsx(R,{width:"100%",height:a,children:t.jsxs(F,{data:o,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:u,x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:d.primary,stopOpacity:1}),t.jsx("stop",{offset:"100%",stopColor:d.primary,stopOpacity:.5})]})}),t.jsx(H,{..._(d)}),t.jsx(X,{dataKey:n,tick:C(d)}),t.jsx(O,{tick:C(d),width:B}),t.jsx(J,{contentStyle:k(d.mode),itemStyle:{color:d.mode==="light"?"#111827":"#F8FAFC",fontSize:12,fontWeight:600},labelStyle:{color:d.mode==="light"?"#6B7280":"#CBD5E1",fontSize:11,fontWeight:600}}),t.jsx(K,{dataKey:r,fill:`url(#${u})`,radius:[4,4,0,0]})]})})}const z=["","Mon","","Wed","","Fri",""],I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(o){const r=o.getFullYear(),n=String(o.getMonth()+1).padStart(2,"0"),a=String(o.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}function P(o){const r=o.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!r)return null;const n=Number(r[1]),a=Number(r[2])-1,m=Number(r[3]),l=new Date(n,a,m);return Number.isNaN(l.getTime())||l.getFullYear()!==n||l.getMonth()!==a||l.getDate()!==m?null:l}function q(o,r){if(o<=0||r<=0)return 0;const n=o/r;return n<=.25?1:n<=.5?2:n<=.75?3:4}function nt({data:o,summary:r,cellSize:n=13,cellGap:a=3,className:m}){const[l,u]=S.useState(null),d=$(),{grid:T,monthLabels:A,maxVal:V}=S.useMemo(()=>{if(o.length===0)return{grid:[],monthLabels:[],maxVal:0};const i=new Map;let c=0;const h=[];for(const e of o){const s=P(e.date);if(!s)continue;const p=L(s);i.set(p,e.value),e.value>c&&(c=e.value),h.push(s)}if(h.length===0)return{grid:[],monthLabels:[],maxVal:0};const g=new Date(Math.min(...h.map(e=>e.getTime()))),x=new Date(Math.max(...h.map(e=>e.getTime()))),f=new Date(g);f.setDate(f.getDate()-f.getDay());const D=new Date(x);D.setDate(D.getDate()+(6-D.getDay()));const M=[],y=new Date(f);for(;y<=D;){const e=[];for(let s=0;s<7;s++){const p=L(y);e.push({date:new Date(y),key:p,value:i.get(p)??0}),y.setDate(y.getDate()+1)}M.push(e)}const j=new Map;let v=-1;M.forEach((e,s)=>{e.forEach(p=>{p.date>=g&&p.date<=x&&(v<0&&(v=s),p.date.getDate()===1&&j.set(s,I[p.date.getMonth()]))})}),v>=0&&!j.has(v)&&j.set(v,I[g.getMonth()]);const W=Array.from(j.entries()).map(([e,s])=>({weekIndex:e,label:s})).sort((e,s)=>e.weekIndex-s.weekIndex),w=[];for(const e of W){const s=w[w.length-1];(!s||e.weekIndex-s.weekIndex>=2)&&w.push(e)}return{grid:M,monthLabels:w,maxVal:c}},[o]),E=T.length,b=32,N=Math.max(0,E*(n+a)-a);return t.jsxs("div",{className:m,children:[t.jsx("div",{style:{display:"flex",marginLeft:b+a,marginBottom:"4px",position:"relative",height:"16px",width:N},children:A.map((i,c)=>t.jsx("span",{style:{position:"absolute",left:i.weekIndex*(n+a),fontSize:"11px",color:"var(--t4)",fontWeight:500},children:i.label},`${i.label}-${c}`))}),t.jsxs("div",{style:{display:"flex",gap:`${a}px`},children:[t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:`${a}px`,width:b,flexShrink:0},children:z.map((i,c)=>t.jsx("div",{style:{height:n,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"6px",fontSize:"11px",color:"var(--t4)",fontWeight:500},children:i},c))}),T.map((i,c)=>t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:`${a}px`},children:i.map(h=>{const g=q(h.value,V);return t.jsx("div",{className:`hmc hm${g}`,style:{width:n,height:n},onMouseEnter:x=>u({x:x.clientX,y:x.clientY,text:`${h.value} on ${h.key}`}),onMouseMove:x=>u(f=>f?{...f,x:x.clientX,y:x.clientY}:null),onMouseLeave:()=>u(null)},h.key)})},c))]}),t.jsxs("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"12px",flexWrap:"wrap",marginTop:"10px",marginLeft:b+a},children:[r&&t.jsx("span",{style:{fontSize:"11px",color:"var(--t4)"},children:r}),t.jsxs("div",{className:"hmleg",children:[t.jsx("span",{children:"Less"}),[0,1,2,3,4].map(i=>t.jsx("i",{className:`hm${i}`},i)),t.jsx("span",{children:"More"})]})]}),l&&Y.createPortal(t.jsx("div",{style:{position:"fixed",zIndex:999,fontFamily:"var(--font)",pointerEvents:"none",whiteSpace:"nowrap",left:l.x+12,top:l.y-32,...k(d.mode)},children:l.text}),document.body)]})}export{nt as V,et as a};
